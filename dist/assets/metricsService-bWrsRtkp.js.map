{"version":3,"file":"metricsService-bWrsRtkp.js","sources":["../../src/services/metricsService.js"],"sourcesContent":["import axios from \"axios\";\nimport { handleResponse, handleError } from \"../utils/helpers\";\nimport { BASE_API_URL } from \"../utils/constants\";\n\nexport const fetchMetrics = async (data) => {\n  try {\n    const res = await axios.post(`${BASE_API_URL}/retailers/metrics`, data);\n\n    return handleResponse(res);\n  } catch (err) {\n    return handleError(err);\n  }\n};\n\nexport const fetchWeeklyRatings = async () => {\n  try {\n    const res = await axios.get(`${BASE_API_URL}/retailers/weekly-ratings`);\n    return handleResponse(res);\n  } catch (err) {\n    return handleError(err);\n  }\n};\n\nexport const fetchWeeklyPricings = async () => {\n  try {\n    const res = await axios.get(`${BASE_API_URL}/retailers/weekly-pricing`);\n    return handleResponse(res);\n  } catch (err) {\n    return handleError(err);\n  }\n};\n\nexport const downloadMetricsCSV = async (data) => {\n  try {\n    const res = await axios.post(\n      `${BASE_API_URL}/retailers/metrics/export`, data,\n      {\n        responseType: \"blob\",\n      }\n    );\n\n    const contentDisposition = res.headers[\"content-disposition\"];\n    console.log(contentDisposition)\n    let fileName = \"metrics.csv\";\n    if (contentDisposition) {\n      const fileNameMatch = contentDisposition.match(/filename=(.+)/);\n      if (fileNameMatch && fileNameMatch[1]) {\n        fileName = fileNameMatch[1];\n      }\n    }\n\n    const link = document.createElement(\"a\");\n    link.href = window.URL.createObjectURL(res.data);\n    link.download = fileName;\n    link.click();\n\n    window.URL.revokeObjectURL(link.href);\n\n    return res;\n  } catch (err) {\n    console.error(\"CSV Download Error:\", err);\n  }\n};\n\nexport const downloadScrapedDataCSV = async (\n  startDate,\n  endDate,\n  retailerIds = [],\n  productIds = []\n) => {\n  try {\n    const res = await axios.post(\n      `${BASE_API_URL}/scraped-data/export`,\n      {\n        startDate,\n        endDate,\n        retailer_ids: retailerIds,\n        product_ids: productIds,\n      },\n      {\n        responseType: \"blob\",\n      }\n    );\n\n    const contentDisposition = res.headers[\"content-disposition\"];\n    let fileName = \"scraped_data.csv\";\n    if (contentDisposition) {\n      const fileNameMatch = contentDisposition.match(/filename=\"(.+)\"/);\n      if (fileNameMatch && fileNameMatch[1]) {\n        fileName = fileNameMatch[1];\n      }\n    }\n\n    const link = document.createElement(\"a\");\n    link.href = window.URL.createObjectURL(res.data);\n    link.download = fileName;\n    link.click();\n\n    window.URL.revokeObjectURL(link.href);\n\n    return res;\n  } catch (err) {\n    console.error(\"CSV Download Error:\", err);\n  }\n};\n"],"names":["fetchMetrics","data","res","axios","BASE_API_URL","handleResponse","err","handleError","fetchWeeklyRatings","fetchWeeklyPricings","downloadMetricsCSV","contentDisposition","fileName","fileNameMatch","link","downloadScrapedDataCSV","startDate","endDate","retailerIds","productIds"],"mappings":"6DAIY,MAACA,EAAe,MAAOC,GAAS,CAC1C,GAAI,CACF,MAAMC,EAAM,MAAMC,EAAM,KAAK,GAAGC,CAAY,qBAAsBH,CAAI,EAEtE,OAAOI,EAAeH,CAAG,CAC1B,OAAQI,EAAK,CACZ,OAAOC,EAAYD,CAAG,CAC1B,CACA,EAEaE,EAAqB,SAAY,CAC5C,GAAI,CACF,MAAMN,EAAM,MAAMC,EAAM,IAAI,GAAGC,CAAY,2BAA2B,EACtE,OAAOC,EAAeH,CAAG,CAC1B,OAAQI,EAAK,CACZ,OAAOC,EAAYD,CAAG,CAC1B,CACA,EAEaG,EAAsB,SAAY,CAC7C,GAAI,CACF,MAAMP,EAAM,MAAMC,EAAM,IAAI,GAAGC,CAAY,2BAA2B,EACtE,OAAOC,EAAeH,CAAG,CAC1B,OAAQI,EAAK,CACZ,OAAOC,EAAYD,CAAG,CAC1B,CACA,EAEaI,EAAqB,MAAOT,GAAS,CAChD,GAAI,CACF,MAAMC,EAAM,MAAMC,EAAM,KACtB,GAAGC,CAAY,4BAA6BH,EAC5C,CACE,aAAc,MACtB,CACK,EAEKU,EAAqBT,EAAI,QAAQ,qBAAqB,EAC5D,QAAQ,IAAIS,CAAkB,EAC9B,IAAIC,EAAW,cACf,GAAID,EAAoB,CACtB,MAAME,EAAgBF,EAAmB,MAAM,eAAe,EAC1DE,GAAiBA,EAAc,CAAC,IAClCD,EAAWC,EAAc,CAAC,EAElC,CAEI,MAAMC,EAAO,SAAS,cAAc,GAAG,EACvC,OAAAA,EAAK,KAAO,OAAO,IAAI,gBAAgBZ,EAAI,IAAI,EAC/CY,EAAK,SAAWF,EAChBE,EAAK,MAAO,EAEZ,OAAO,IAAI,gBAAgBA,EAAK,IAAI,EAE7BZ,CACR,OAAQI,EAAK,CACZ,QAAQ,MAAM,sBAAuBA,CAAG,CAC5C,CACA,EAEaS,EAAyB,MACpCC,EACAC,EACAC,EAAc,CAAE,EAChBC,EAAa,CAAA,IACV,CACH,GAAI,CACF,MAAMjB,EAAM,MAAMC,EAAM,KACtB,GAAGC,CAAY,uBACf,CACE,UAAAY,EACA,QAAAC,EACA,aAAcC,EACd,YAAaC,CACd,EACD,CACE,aAAc,MACtB,CACK,EAEKR,EAAqBT,EAAI,QAAQ,qBAAqB,EAC5D,IAAIU,EAAW,mBACf,GAAID,EAAoB,CACtB,MAAME,EAAgBF,EAAmB,MAAM,iBAAiB,EAC5DE,GAAiBA,EAAc,CAAC,IAClCD,EAAWC,EAAc,CAAC,EAElC,CAEI,MAAMC,EAAO,SAAS,cAAc,GAAG,EACvC,OAAAA,EAAK,KAAO,OAAO,IAAI,gBAAgBZ,EAAI,IAAI,EAC/CY,EAAK,SAAWF,EAChBE,EAAK,MAAO,EAEZ,OAAO,IAAI,gBAAgBA,EAAK,IAAI,EAE7BZ,CACR,OAAQI,EAAK,CACZ,QAAQ,MAAM,sBAAuBA,CAAG,CAC5C,CACA"}