{"version":3,"file":"Edit-CN-ve7pU.js","sources":["../../src/views/product/Edit.vue"],"sourcesContent":["<script>\nimport { mapGetters, mapActions } from \"vuex\";\n\nimport ArgonButton from \"@/components/ArgonButton.vue\";\nimport ArgonInput from \"@/components/ArgonInput.vue\";\nimport PackSizeSelect from \"@/components/PackSizeSelect.vue\";\n\nimport { updateProduct } from \"@/services/productsService\";\n\nexport default {\n  name: \"Product Edit\",\n  components: {\n    ArgonInput,\n    ArgonButton,\n    PackSizeSelect,\n  },\n  data() {\n    return {\n      updateProductForm: {\n        title: \"\",\n        description: \"\",\n        manufacturer_part_number: \"\",\n        pack_size_id: null,\n        images: [],\n      },\n      maxImages: 5,\n      newImages: [],\n      loading: false,\n      validationErrors: {},\n    };\n  },\n  computed: {\n    ...mapGetters(\"products\", [\"getProducts\"]),\n    ...mapGetters({\n      packSizes: \"packSizes/getPackSizes\",\n    }),\n    productId() {\n      return this.$route.params.id;\n    },\n    selectedProduct() {\n      return this.getProducts.find((product) => product.id == this.productId);\n    },\n    totalImagesCount() {\n      return this.updateProductForm.images.length + this.newImages.length;\n    },\n  },\n  watch: {\n    selectedProduct: {\n      immediate: true,\n      handler(newProduct) {\n        if (newProduct) {\n          this.updateProductForm = {\n            title: newProduct.title,\n            description: newProduct.description,\n            manufacturer_part_number: newProduct.manufacturer_part_number,\n            pack_size_id: newProduct.pack_size.id,\n            images: newProduct.images || [],\n          };\n          this.newImages = [];\n        }\n      },\n    },\n  },\n  methods: {\n    ...mapActions(\"products\", [\"updateProduct\"]),\n    async handleUpdate() {\n      this.validationErrors = {};\n      const res = await updateProduct(\n        this.updateProductForm,\n        this.newImages,\n        this.productId\n      );\n\n      if (res.success) {\n        this.updateProduct(res.data);\n        this.$router.push({ name: \"Products\" });\n      } else {\n        if (res.errors) {\n          this.validationErrors = res.errors;\n        }\n      }\n    },\n    handleFileChange(event, index) {\n      const file = event.target.files[0];\n      if (file) {\n        this.newImages[index] = file;\n      }\n    },\n    addNewInputField() {\n      if (this.totalImagesCount < this.maxImages) {\n        this.newImages.push(null);\n      }\n    },\n    removeNewInputField() {\n      if (this.newImages.length > 0) {\n        this.newImages.pop();\n      }\n    },\n    removeExistingImage(index) {\n      this.updateProductForm.images.splice(index, 1);\n    },\n    getPreviewUrl(file) {\n      return file && window.URL ? window.URL.createObjectURL(file) : \"\";\n    },\n  },\n};\n</script>\n\n<template>\n  <div class=\"container-fluid py-4 flex-grow-1\">\n    <div class=\"row\">\n      <div class=\"col-lg-8 col-md-8 mx-auto\">\n        <div class=\"card\">\n          <div class=\"card-header pb-0 text-center\">\n            <h6 class=\"text-primary\">Edit Product</h6>\n          </div>\n\n          <div class=\"card-body\">\n            <form @submit.prevent=\"handleUpdate\">\n              <div class=\"mb-3\">\n                <label class=\"form-label\">Product Title</label>\n                <argon-input\n                  v-model.trim.lazy=\"updateProductForm.title\"\n                  type=\"text\"\n                  placeholder=\"Enter product name\"\n                  required\n                />\n                <div v-if=\"validationErrors.title\" class=\"text-danger\">\n                  {{ validationErrors.title[0] }}\n                </div>\n              </div>\n\n              <div class=\"mb-3\">\n                <label class=\"form-label\">Description</label>\n                <textarea\n                  v-model.trim.lazy=\"updateProductForm.description\"\n                  class=\"form-control\"\n                  placeholder=\"Enter product description\"\n                ></textarea>\n                <div v-if=\"validationErrors.description\" class=\"text-danger\">\n                  {{ validationErrors.description[0] }}\n                </div>\n              </div>\n\n              <div class=\"mb-3\">\n                <label class=\"form-label\">Manufacturer Part Number</label>\n                <argon-input\n                  v-model.trim.lazy=\"updateProductForm.manufacturer_part_number\"\n                  type=\"text\"\n                  placeholder=\"Enter manufacturer part number\"\n                  required\n                />\n                <div\n                  v-if=\"validationErrors.manufacturer_part_number\"\n                  class=\"text-danger\"\n                >\n                  {{ validationErrors.manufacturer_part_number[0] }}\n                </div>\n              </div>\n\n              <div class=\"mb-3\">\n                <label class=\"form-label\">Pack Size</label>\n                <pack-size-select\n                  :options=\"packSizes\"\n                  v-model=\"updateProductForm.pack_size_id\"\n                  name=\"pack_size\"\n                />\n                <div v-if=\"validationErrors.pack_size_id\" class=\"text-danger\">\n                  {{ validationErrors.pack_size_id[0] }}\n                </div>\n              </div>\n\n              <div class=\"mb-3\" v-if=\"updateProductForm.images.length\">\n                <label class=\"form-label\">Images</label>\n                <div\n                  v-for=\"(image, index) in updateProductForm.images\"\n                  :key=\"image.id\"\n                >\n                  <div class=\"mb-3 d-flex flex-column\">\n                    <img\n                      :src=\"image.file_url\"\n                      :alt=\"image.file_name\"\n                      class=\"img-thumbnail m-1 w-50\"\n                      width=\"100\"\n                    />\n                    <argon-button\n                      color=\"danger\"\n                      class=\"ms-2 w-15 mt-2\"\n                      @click=\"removeExistingImage(index)\"\n                      >Remove</argon-button\n                    >\n                  </div>\n                </div>\n              </div>\n\n              <div class=\"mb-3\">\n                <label class=\"form-label\">New Images</label>\n                <div v-if=\"validationErrors.images\" class=\"text-danger\">\n                  {{ validationErrors.images[0] }}\n                </div>\n                <div\n                  v-for=\"(file, index) in newImages\"\n                  :key=\"'new-' + index\"\n                  class=\"mb-3\"\n                >\n                  <input\n                    type=\"file\"\n                    class=\"form-control\"\n                    accept=\"image/*\"\n                    @change=\"handleFileChange($event, index)\"\n                  />\n                  <div v-if=\"file\">\n                    <img\n                      :src=\"getPreviewUrl(file)\"\n                      alt=\"New image preview\"\n                      class=\"img-thumbnail m-1 w-50\"\n                      width=\"100\"\n                    />\n                  </div>\n                  <div\n                    v-if=\"validationErrors[`images.${index}`]\"\n                    class=\"text-danger\"\n                  >\n                    {{ validationErrors[`images.${index}`][0] }}\n                  </div>\n                </div>\n              </div>\n\n              <argon-button\n                color=\"primary\"\n                class=\"mt-2 mb-4\"\n                @click.prevent=\"addNewInputField\"\n                :disabled=\"totalImagesCount >= maxImages\"\n              >\n                Add\n              </argon-button>\n\n              <argon-button\n                color=\"primary\"\n                class=\"mt-2 mb-4 ms-2\"\n                @click.prevent=\"removeNewInputField\"\n                :disabled=\"newImages.length <= 0\"\n              >\n                Remove\n              </argon-button>\n\n              <div class=\"text-center\">\n                <argon-button type=\"submit\" color=\"primary\" :disabled=\"loading\">\n                  {{ loading ? \"Updating...\" : \"Update Product\" }}\n                </argon-button>\n                <argon-button\n                  color=\"secondary\"\n                  class=\"ms-2\"\n                  @click=\"$router.push('/products')\"\n                >\n                  Cancel\n                </argon-button>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n"],"names":["_sfc_main","ArgonInput","ArgonButton","PackSizeSelect","mapGetters","product","newProduct","mapActions","res","updateProduct","event","index","file","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_8","_hoisted_10","_hoisted_12","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_19","_hoisted_21","_hoisted_23","_openBlock","_createElementBlock","_createElementVNode","_cache","_withModifiers","$options","args","_createVNode","_component_argon_input","$data","$event","_hoisted_7","_toDisplayString","_createCommentVNode","_hoisted_9","_hoisted_11","_component_pack_size_select","_ctx","_hoisted_13","_hoisted_14","_Fragment","_renderList","image","_component_argon_button","_withCtx","_createTextVNode","_hoisted_18","_hoisted_20","_hoisted_22"],"mappings":"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"}